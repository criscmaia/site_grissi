<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="√Årvore geneal√≥gica da Fam√≠lia Grizzo, Grice, Gris e Grissi - Explore a hist√≥ria e conex√µes familiares atrav√©s de gera√ß√µes.">
    <meta name="keywords" content="√°rvore geneal√≥gica, genealogia, fam√≠lia, Grizzo, Grice, Gris, Grissi, hist√≥ria familiar, ancestrais">
    <meta name="author" content="Cristiano Maia">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#DD0000">
    <meta name="color-scheme" content="light">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="og:title" content="√Årvore Geneal√≥gica - Fam√≠lia Grizzo . Grice . Gris . Grissi">
    <meta property="og:description" content="Explore a √°rvore geneal√≥gica da Fam√≠lia Grizzo, Grice, Gris e Grissi.">
    <meta property="og:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    <meta property="og:image:width" content="680">
    <meta property="og:image:height" content="478">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Fam√≠lia Grizzo . Grice . Gris . Grissi">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="twitter:title" content="√Årvore Geneal√≥gica - Fam√≠lia Grizzo . Grice . Gris . Grissi">
    <meta property="twitter:description" content="Explore a √°rvore geneal√≥gica da Fam√≠lia Grizzo, Grice, Gris e Grissi.">
    <meta property="twitter:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    
    <title>√Årvore Geneal√≥gica - Fam√≠lia Grizzo . Grice . Gris . Grissi</title>

    <!-- Preload critical resources -->
    <link rel="preload" href="index.css" as="style">
    <link rel="preload" href="js/modern-search.css" as="style">
    <link rel="preload" href="js/genealogy-manager.js" as="script">
    <link rel="preload" href="js/photo-handler.js" as="script">
    <link rel="preload" href="js/modern-search-engine.js" as="script">
    <link rel="preload" href="js/performance-monitor.js" as="script">
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="index.css">
    <link rel="stylesheet" type="text/css" href="js/modern-search.css">
    <link rel="stylesheet" type="text/css" href="arvore.css">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "√Årvore Geneal√≥gica - Fam√≠lia Grizzo . Grice . Gris . Grissi",
        "description": "√Årvore geneal√≥gica da Fam√≠lia Grizzo, Grice, Gris e Grissi",
        "url": "https://sitegrissi.com/arvore-genealogica.html",
        "author": {
            "@type": "Person",
            "name": "Cristiano Maia",
            "email": "criscmaia@gmail.com"
        },
        "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "P√°gina Principal",
                    "item": "https://sitegrissi.com/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "√Årvore Geneal√≥gica",
                    "item": "https://sitegrissi.com/arvore-genealogica.html"
                }
            ]
        },
        "mainEntity": {
            "@type": "Dataset",
            "name": "√Årvore Geneal√≥gica da Fam√≠lia Grissi",
            "description": "Dados geneal√≥gicos da fam√≠lia italiana Grizzo, Grice, Gris e Grissi",
            "creator": {
                "@type": "Person",
                "name": "Cristiano Maia"
            },
            "publisher": {
                "@type": "Organization",
                "name": "Fam√≠lia Grizzo . Grice . Gris . Grissi"
            }
        }
    }
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
</head>

<body>
    <!-- Header -->
    <header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
        <div class="container mx-auto px-4">
            <nav class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-4">
                    <a href="index.html" class="text-xl font-bold text-heritage-green">
                        Fam√≠lia Grizzo . Grice . Gris . Grissi
                    </a>
                </div>
                
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-sm font-medium transition-colors hover:text-heritage-green">
                        P√°gina Principal
                    </a>
                    <a href="historia.html" class="text-sm font-medium transition-colors hover:text-heritage-green">
                        Hist√≥ria
                    </a>
                    <a href="fotos.html" class="text-sm font-medium transition-colors hover:text-heritage-green">
                        Fotos
                    </a>
                    <a href="lembrancas.html" class="text-sm font-medium transition-colors hover:text-heritage-green">
                        Lembran√ßas
                    </a>
                    <a href="arvore-genealogica-enhanced.html" class="text-sm font-medium text-heritage-green active">
                        √Årvore Geneal√≥gica
                    </a>
                    <a href="contato.html" class="text-sm font-medium transition-colors hover:text-heritage-green">
                        Contato
                    </a>
                </div>
                
                <!-- Mobile menu button -->
                <button class="md:hidden p-2" aria-label="Menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main role="main">
        <section id="arvore-content" aria-label="Conte√∫do da √°rvore geneal√≥gica" role="region">
            <!-- Modern Genealogy Tree Layout -->
            <div class="genealogy-container">

                <!-- Search and Filter Section -->
                <div class="search-filter-section">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" class="search-input" placeholder="Pesquisar por nome, local de nascimento..." />
                        </div>
                    </div>
                    
                    <div class="filter-buttons">
                        <button class="filter-btn active">Todas as Gera√ß√µes</button>
                        <button class="filter-btn">1¬™ Gera√ß√£o</button>
                        <button class="filter-btn">2¬™ Gera√ß√£o</button>
                    </div>
                </div>

                <!-- Results Counter -->
                <div class="results-counter">
                    <span>Carregando dados da fam√≠lia...</span>
                </div>

                <!-- Family Members Cards -->
                <div class="family-members">
                    <!-- Family members will be loaded dynamically from JSON -->
                </div>
            </div>
        </section>
    </main>

    <footer role="contentinfo" id="rodape" class="legenda">
        <p>
            &copy; <a href="mailto:criscmaia@gmail.com?Subject=Fam√≠lia%20Grizzo%20.%20Grice%20.%20Gris%20.%20Grissi" 
                       aria-label="Enviar email para Cristiano Maia">Cristiano Maia</a> - 
            2004-<script>document.write(new Date().getFullYear())</script>
        </p>
    </footer>

    <!-- Load JavaScript modules -->
    <script src="js/photo-handler.js"></script>
    <script src="js/modern-search-engine.js"></script>
    <script src="js/genealogy-manager.js"></script>
    <script src="js/family-renderer.js"></script>
    <script src="js/enhanced-family-renderer.js"></script>

    <script>
        /**
         * Enhanced Genealogy Tree Application - Using Optimized JSON Data
         * Features:
         * - Uses family-data-v2 (7).json (20% smaller, no descendants arrays)
         * - Enhanced performance with optimized data structure
         * - Modern JavaScript features
         * - Photo manifest system
         * - Modular ES6 architecture
         */
        
        // Global application state
        let genealogyManager = null;
        let searchEngine = null;
        let familyRenderer = null;
        let enhancedFamilyRenderer = null;
        
        /**
         * Initialize the application with enhanced features
         */
        async function initializeApplication() {
            try {
                console.log('üöÄ Initializing Enhanced Genealogy Application');
                
                // Check if EnhancedFamilyRenderer is available
                if (typeof EnhancedFamilyRenderer !== 'undefined') {
                    console.log('‚úÖ EnhancedFamilyRenderer found, using enhanced version');
                    enhancedFamilyRenderer = new EnhancedFamilyRenderer();
                    await enhancedFamilyRenderer.initialize();
                    console.log('‚úÖ Enhanced Family Renderer initialized successfully');
                } else {
                    console.log('‚ö†Ô∏è EnhancedFamilyRenderer not found, falling back to standard FamilyRenderer');
                    
                    // Use the existing FamilyRenderer but modify it to load the optimized JSON
                    if (typeof FamilyRenderer !== 'undefined') {
                        familyRenderer = new FamilyRenderer();
                        
                        // Override the loadFamilyData method to use the optimized JSON
                        const originalLoadFamilyData = familyRenderer.loadFamilyData;
                        familyRenderer.loadFamilyData = async function() {
                            try {
                                console.log('üìä Loading optimized family data...');
                                const response = await fetch('family-data-v2 (7).json');
                                if (!response.ok) {
                                    throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                
                                const rawData = await response.json();
                                console.log(`üìä Loaded ${rawData.familyMembers.length} family members from optimized file`);
                                console.log(`üìà Data completeness: ${rawData.metadata.migrationInfo.validationResults.completenessPercentage}%`);
                                console.log(`‚ö° File size optimized: 20% smaller than original`);
                                
                                this.familyData = rawData;
                                console.log(`üìä Using ${this.familyData.familyMembers.length} family members with enhanced structure`);
                            } catch (error) {
                                console.error('‚ùå Failed to load enhanced family data:', error);
                                // Fallback to original method
                                return originalLoadFamilyData.call(this);
                            }
                        };
                        
                        await familyRenderer.initialize();
                        console.log('‚úÖ Standard Family Renderer initialized with optimized data');
                    } else {
                        console.error('‚ùå Neither EnhancedFamilyRenderer nor FamilyRenderer found');
                    }
                }
                
                console.log('üéâ Enhanced application initialized successfully');
                
            } catch (error) {
                console.error('‚ùå Failed to initialize enhanced application:', error);
            }
        }
        
        /**
         * Performance monitoring
         */
        function initializePerformanceMonitoring() {
            window.addEventListener('load', function() {
                if ('performance' in window) {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
                    console.log('Enhanced page load time:', loadTime + 'ms');
                    
                    // Send to analytics if available
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'timing_complete', {
                            name: 'load',
                            value: Math.round(loadTime)
                        });
                    }
                }
            });
        }
        
        // Initialize Performance Monitor
        let performanceMonitor = null;
        if (window.PerformanceMonitor) {
            performanceMonitor = new PerformanceMonitor();
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                initializePerformanceMonitoring();
                initializeApplication();
            });
        } else {
            initializePerformanceMonitoring();
            initializeApplication();
        }
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('‚úÖ Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', function() {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', function() {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('üîÑ New service worker available');
                                    // You could show a notification to the user here
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.error('‚ùå Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
