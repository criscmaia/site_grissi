<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Árvore genealógica da Família Grizzo, Grice, Gris e Grissi - Explore a história e conexões familiares através de gerações.">
    <meta name="keywords" content="árvore genealógica, genealogia, família, Grizzo, Grice, Gris, Grissi, história familiar, ancestrais">
    <meta name="author" content="Cristiano Maia">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#DD0000">
    <meta name="color-scheme" content="light">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="og:title" content="Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi">
    <meta property="og:description" content="Explore a árvore genealógica da Família Grizzo, Grice, Gris e Grissi.">
    <meta property="og:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    <meta property="og:image:width" content="680">
    <meta property="og:image:height" content="478">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Família Grizzo . Grice . Gris . Grissi">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="twitter:title" content="Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi">
    <meta property="twitter:description" content="Explore a árvore genealógica da Família Grizzo, Grice, Gris e Grissi.">
    <meta property="twitter:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    
    <title>Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi</title>

    <!-- Preload critical resources -->
    <link rel="preload" href="index.css" as="style">
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    
    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="index.css">

    <link rel="stylesheet" type="text/css" href="arvore.css?v=20250809-1">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
    
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi",
        "description": "Árvore genealógica da Família Grizzo, Grice, Gris e Grissi",
        "url": "https://sitegrissi.com/arvore-genealogica.html",
        "author": {
            "@type": "Person",
            "name": "Cristiano Maia",
            "email": "criscmaia@gmail.com"
        },
        "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Página Principal",
                    "item": "https://sitegrissi.com/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Árvore Genealógica",
                    "item": "https://sitegrissi.com/arvore-genealogica.html"
                }
            ]
        },
        "mainEntity": {
            "@type": "Dataset",
            "name": "Árvore Genealógica da Família Grissi",
            "description": "Dados genealógicos da família italiana Grizzo, Grice, Gris e Grissi",
            "creator": {
                "@type": "Person",
                "name": "Cristiano Maia"
            },
            "publisher": {
                "@type": "Organization",
                "name": "Família Grizzo . Grice . Gris . Grissi"
            }
        }
    }
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX');
    </script>
</head>

<body>
    <!-- Header -->
    <header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
        <div class="container">
            <a href="/" class="flex items-center space-x-2">
                <div class="heritage-gradient">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z"></path>
                        <path d="M12 22v-3"></path>
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>Família Grissi</h1>
                    <p>Uma família originalmente italiana</p>
                </div>
            </a>
            
            <nav class="nav-desktop">
                <a class="nav-link" href="./">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
                        <path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    </svg>
                    Início
                </a>
                <a class="nav-link active" href="./arvore-genealogica.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z"></path>
                        <path d="M12 22v-3"></path>
                    </svg>
                    Árvore Genealógica
                </a>
                <a class="nav-link" href="./historia.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                        <path d="M3 3v5h5"></path>
                        <path d="M12 7v5l4 2"></path>
                    </svg>
                    História
                </a>
                <a class="nav-link" href="./lembrancas.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
                    </svg>
                    Lembranças
                </a>
                <a class="nav-link" href="./fotos.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path>
                        <circle cx="12" cy="13" r="3"></circle>
                    </svg>
                    Fotos
                </a>
                <a class="nav-link" href="./atualizacoes.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Atualizações
                </a>
                <a class="nav-link" href="./contato.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                    </svg>
                    Contato
                </a>
            </nav>
            
            <button class="mobile-menu-btn" type="button" aria-label="Abrir menu">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="4" x2="20" y1="12" y2="12"></line>
                    <line x1="4" x2="20" y1="6" y2="6"></line>
                    <line x1="4" x2="20" y1="18" y2="18"></line>
                </svg>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main role="main">
        <section id="arvore-content" aria-label="Conteúdo da árvore genealógica" role="region">
            <!-- Modern Genealogy Tree Layout -->
            <div class="genealogy-container">

                <!-- Search and Filter Section -->
                <div class="search-filter-section">
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                            <input type="text" class="search-input" placeholder="Pesquisar por nome, local de nascimento..." />
                        </div>
                        
                        
                    </div>
                    
                    <div class="filter-buttons">
                        <button class="filter-btn active">Todas as Gerações</button>
                        <button class="filter-btn">1ª Geração</button>
                        <button class="filter-btn">2ª Geração</button>
                        <button class="filter-btn">3ª Geração</button>
                        <button class="filter-btn">4ª Geração</button>
                        <button class="filter-btn">5ª Geração</button>
                        <button class="filter-btn">6ª Geração</button>
                        <button class="filter-btn">7ª Geração</button>
                    </div>
                </div>

                <!-- Results Counter -->
                <div class="results-counter">
                    <span>Carregando dados da família...</span>
                </div>

                <!-- Family Members Cards -->
                <div class="family-members">
                    <!-- Family members will be loaded dynamically from JSON -->
                </div>
            </div>
        </section>
    </main>

    <footer role="contentinfo" id="rodape" class="legenda">
        <p>
            &copy; <a href="mailto:criscmaia@gmail.com?Subject=Família%20Grizzo%20.%20Grice%20.%20Gris%20.%20Grissi" 
                       aria-label="Enviar email para Cristiano Maia">Cristiano Maia</a> - 
            2004-<script>document.write(new Date().getFullYear())</script>
        </p>
    </footer>

    <!-- Load JavaScript modules -->
    <script src="js/photo-matcher.js"></script>
    <script src="js/photo-popup.js"></script>
    
    <script src="js/final-family-renderer.js"></script>
    <script src="js/search-filter-controller.js"></script>
    <script src="js/export-manager.js"></script>
    <script src="js/share-manager.js"></script>

    <script>
        /**
         * Modern Genealogy Tree Application - Final Version
         * Features:
         * - Photo manifest system (eliminates 120+ HTTP requests)
         * - Modular ES6 architecture
         * - Enhanced error handling
         * - Modern JavaScript features
         * - Optimized DOM operations
         * - Loads from genealogy.json (final version)
         */
        
        // Global application state
        let searchEngine = null;
        let familyRenderer = null;
        let photoPopup = null;
        let exportManager = null;
        let shareManager = null;
        
        /**
         * Initialize the application with modern features
         */
        async function initializeApplication() {
            try {
                console.log('🚀 Initializing Final Genealogy Application');
                
                // Initialize Photo Popup
                if (window.PhotoPopup) {
                    photoPopup = new PhotoPopup();
                    window.photoPopup = photoPopup; // Make globally available
                    console.log('✅ Photo Popup initialized successfully');
                } else {
                    console.warn('⚠️ PhotoPopup not available');
                }
                
                // Initialize Family Renderer
                if (window.FinalFamilyRenderer) {
                    familyRenderer = new FinalFamilyRenderer();
                    await familyRenderer.initialize();
                    console.log('✅ Final Family Renderer initialized successfully');
                } else {
                    console.error('❌ FinalFamilyRenderer not found');
                }
                
                // Initialize search functionality (if needed later)
                // Search is now handled by search-filter-controller.js
                
                // Initialize Share Manager
                if (window.ShareManager) {
                    shareManager = new ShareManager();
                    shareManager.init();
                    window.shareManager = shareManager; // Make globally available
                    console.log('✅ Share Manager initialized successfully');
                } else {
                    console.warn('⚠️ ShareManager not available');
                }
                
                // Initialize Export Manager (admin mode - set to true for admin access)
                if (window.ExportManager) {
                    exportManager = new ExportManager();
                    exportManager.init(familyRenderer?.familyData || null, false); // Set to true for admin
                    window.exportManager = exportManager; // Make globally available
                    console.log('✅ Export Manager initialized successfully');
                } else {
                    console.warn('⚠️ ExportManager not available');
                }
                
                console.log('🎉 Final application initialized successfully');
                
            } catch (error) {
                console.error('❌ Failed to initialize final application:', error);
            }
        }
        
        /**
         * Performance monitoring
         */
        function initializePerformanceMonitoring() {
            window.addEventListener('load', function() {
                if ('performance' in window) {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
                    console.log('Page load time:', loadTime + 'ms');
                    
                    // Send to analytics if available
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'timing_complete', {
                            name: 'load',
                            value: Math.round(loadTime)
                        });
                    }
                }
            });
        }
        
        // Initialize Performance Monitor
        let performanceMonitor = null;
        if (window.PerformanceMonitor) {
            performanceMonitor = new PerformanceMonitor();
        }
        
            // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                
                // Ensure advanced filters are hidden by default
                document.body.classList.remove('show-advanced-filters');
                // Ensure fresh assets on GitHub Pages by clearing old SW/caches
                (async function ensureFreshOnGhPages(){
                    if (location.hostname.endsWith('github.io')) {
                        try {
                            if ('serviceWorker' in navigator) {
                                const regs = await navigator.serviceWorker.getRegistrations();
                                for (const reg of regs) { try { await reg.unregister(); } catch {}
                                }
                            }
                            if (window.caches) {
                                const keys = await caches.keys();
                                await Promise.all(
                                    keys.filter(k => /sitegrissi|static|dynamic/i.test(k))
                                        .map(k => caches.delete(k))
                                );
                            }
                        } catch (e) { console.warn('Cache/SW cleanup skipped:', e); }
                    }
                })();
                initializePerformanceMonitoring();
                initializeApplication();
            });
        } else {
            // Ensure advanced filters are hidden by default
            document.body.classList.remove('show-advanced-filters');
            // Ensure fresh assets on GitHub Pages by clearing old SW/caches
            (async function ensureFreshOnGhPages(){
                if (location.hostname.endsWith('github.io')) {
                    try {
                        if ('serviceWorker' in navigator) {
                            const regs = await navigator.serviceWorker.getRegistrations();
                            for (const reg of regs) { try { await reg.unregister(); } catch {}
                            }
                        }
                        if (window.caches) {
                            const keys = await caches.keys();
                            await Promise.all(
                                keys.filter(k => /sitegrissi|static|dynamic/i.test(k))
                                    .map(k => caches.delete(k))
                            );
                        }
                    } catch (e) { console.warn('Cache/SW cleanup skipped:', e); }
                }
            })();
            initializePerformanceMonitoring();
            initializeApplication();
        }
        
        
        
        // Mobile menu toggle
        var mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', function() {
                console.log('Mobile menu clicked');
            });
        }
    </script>
</body>
</html>
