<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Árvore genealógica da Família Grizzo, Grice, Gris e Grissi - Explore a história e conexões familiares através de gerações.">
    <meta name="keywords" content="árvore genealógica, genealogia, família, Grizzo, Grice, Gris, Grissi, história familiar, ancestrais">
    <meta name="author" content="Cristiano Maia">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#DD0000">
    <meta name="color-scheme" content="light">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="og:title" content="Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi">
    <meta property="og:description" content="Explore a árvore genealógica da Família Grizzo, Grice, Gris e Grissi.">
    <meta property="og:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    <meta property="og:image:width" content="680">
    <meta property="og:image:height" content="478">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Família Grizzo . Grice . Gris . Grissi">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://sitegrissi.com/arvore-genealogica.html">
    <meta property="twitter:title" content="Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi">
    <meta property="twitter:description" content="Explore a árvore genealógica da Família Grizzo, Grice, Gris e Grissi.">
    <meta property="twitter:image" content="https://sitegrissi.com/images/home/grice2.JPG">
    
    <title>Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi</title>

    <!-- Preload critical resources -->
    <link rel="preload" href="index.css" as="style">
    <link rel="preload" href="js/modern-search.css" as="style">
    <link rel="preload" href="js/genealogy-manager.js" as="script">
    <link rel="preload" href="js/photo-handler.js" as="script">
    <link rel="preload" href="js/modern-search-engine.js" as="script">
    <link rel="preload" href="js/performance-monitor.js" as="script">
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="index.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.1.1/normalize.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="js/modern-search.css">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Árvore Genealógica - Família Grizzo . Grice . Gris . Grissi",
        "description": "Árvore genealógica da Família Grizzo, Grice, Gris e Grissi",
        "url": "https://sitegrissi.com/arvore-genealogica.html",
        "author": {
            "@type": "Person",
            "name": "Cristiano Maia",
            "email": "criscmaia@gmail.com"
        },
        "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Página Principal",
                    "item": "https://sitegrissi.com/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Árvore Genealógica",
                    "item": "https://sitegrissi.com/arvore-genealogica.html"
                }
            ]
        },
        "mainEntity": {
            "@type": "Dataset",
            "name": "Árvore Genealógica da Família Grissi",
            "description": "Dados genealógicos da família italiana Grizzo, Grice, Gris e Grissi",
            "creator": {
                "@type": "Person",
                "name": "Cristiano Maia"
            },
            "publisher": {
                "@type": "Organization",
                "name": "Família Grizzo . Grice . Gris . Grissi"
            }
        }
    }
    </script>

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3HMF6MF627"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3HMF6MF627', {
            page_title: 'Árvore Genealógica',
            page_location: window.location.href
        });
    </script>
    
    <!-- Performance Monitor -->
    <script src="js/performance-monitor.js"></script>
</head>

<body>
    <header role="banner">
        <nav role="navigation" aria-label="Navegação principal">
            <div class="mobile">
                <h1 id="mobile-titulo" aria-label="Título da família">
                    <span>Família Grizzo . Grice . Gris . Grissi</span>
                </h1>
                <p id="mobile-subtitulo" aria-label="Subtítulo da família">
                    <span>Uma família originalmente italiana</span>
                </p>
                <div id="mobile-centralizarmenu">
                    <div id="navcontainer">
                        <ul id="navlist" role="menubar" aria-label="Menu de navegação">
                            <li role="none">
                                <a href="./" role="menuitem" aria-label="Página Principal"> 
                                    Página Principal
                                </a> |
                            </li>
                            <li role="none">
                                <a href="./arvore-genealogica.html" id="current" role="menuitem" aria-current="page" aria-label="Árvore Genealógica (página atual)"> 
                                    Árvore Genealógica
                                </a> |
                            </li>
                            <li role="none">
                                <a href="./historia.html" role="menuitem" aria-label="História da Família"> 
                                    História
                                </a> |
                            </li>
                            <li role="none">
                                <a href="./lembrancas.html" role="menuitem" aria-label="Lembranças da Família"> 
                                    Lembranças
                                </a> |
                            </li>
                            <li role="none">
                                <a href="./fotos.html" role="menuitem" aria-label="Galeria de Fotos"> 
                                    Fotos
                                </a> |
                            </li>
                            <li role="none">
                                <a href="./contato.html" role="menuitem" aria-label="Página de Contato"> 
                                    Contato
                                </a> |
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main role="main" id="intro">
        <section id="arvore-content" aria-label="Conteúdo da árvore genealógica" role="region">
            <!-- The genealogy tree content will be loaded here -->
            <div class="genealogy-loading" aria-live="polite" aria-label="Carregando árvore genealógica">
                <p>Carregando árvore genealógica...</p>
            </div>
        </section>
    </main>

    <footer role="contentinfo" id="rodape" class="legenda">
        <p>
            &copy; <a href="mailto:criscmaia@gmail.com?Subject=Família%20Grizzo%20.%20Grice%20.%20Gris%20.%20Grissi" 
                       aria-label="Enviar email para Cristiano Maia">Cristiano Maia</a> - 
            2004-<script>document.write(new Date().getFullYear())</script>
        </p>
    </footer>

    <!-- Load JavaScript modules -->
    <script src="js/photo-handler.js"></script>
    <script src="js/modern-search-engine.js"></script>
    <script src="js/genealogy-manager.js"></script>

    <script>
        /**
         * Modern Genealogy Tree Application - Phase 1 & 2 Optimizations
         * Features:
         * - Photo manifest system (eliminates 120+ HTTP requests)
         * - Modular ES6 architecture
         * - Enhanced error handling
         * - Modern JavaScript features
         * - Optimized DOM operations
         */
        
        // Global application state
        let genealogyManager = null;
        let searchEngine = null;
        
        /**
         * Initialize the application with modern features
         */
        async function initializeApplication() {
            try {
                console.log('🚀 Initializing Modern Genealogy Application');
                
                // Show loading state
                const contentElement = document.getElementById('arvore-content');
                if (contentElement) {
                    contentElement.classList.add('genealogy-loading');
                    console.log('🔄 Loading state added');
                }
                
                // Initialize the genealogy manager
                if (window.GenealogyManager) {
                    console.log('✅ Using new GenealogyManager');
                    genealogyManager = new window.GenealogyManager();
                } else {
                    console.warn('⚠️ GenealogyManager not found, will fallback');
                    throw new Error('GenealogyManager not available');
                }
                
                // Load and process the genealogy tree
                await genealogyManager.loadGenealogyTree();
                
                // Initialize search functionality
                genealogyManager.initializeSearch();
                
                // Remove loading state
                if (contentElement) {
                    contentElement.classList.remove('genealogy-loading');
                    console.log('✅ Loading state removed');
                }
                
                // Log statistics
                const stats = genealogyManager.getStatistics();
                if (stats) {
                    console.log('📊 Genealogy Statistics:', stats);
                }
                
                console.log('🎉 Application initialized successfully');
                
            } catch (error) {
                console.error('❌ Failed to initialize application:', error);
                
                // Show user-friendly error message
                const contentElement = document.getElementById('arvore-content');
                if (contentElement) {
                    contentElement.classList.remove('genealogy-loading');
                    contentElement.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #721c24; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px; margin: 20px;" role="alert" aria-live="assertive">
                            <h2>Erro ao carregar a árvore genealógica</h2>
                            <p>Desculpe, ocorreu um erro ao carregar o conteúdo. Por favor, tente recarregar a página.</p>
                            <button onclick="location.reload()" style="margin-top: 15px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;" aria-label="Recarregar página">
                                Recarregar Página
                            </button>
                        </div>
                    `;
                }
            }
        }
        
        /**
         * Performance monitoring
         */
        function initializePerformanceMonitoring() {
            window.addEventListener('load', function() {
                if ('performance' in window) {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
                    console.log('Page load time:', loadTime + 'ms');
                    
                    // Send to analytics if available
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'timing_complete', {
                            name: 'load',
                            value: Math.round(loadTime)
                        });
                    }
                }
            });
        }
        
        // Initialize Performance Monitor
        let performanceMonitor = null;
        if (window.PerformanceMonitor) {
            performanceMonitor = new PerformanceMonitor();
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                initializePerformanceMonitoring();
                initializeApplication();
            });
        } else {
            initializePerformanceMonitoring();
            initializeApplication();
        }
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('✅ Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', function() {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', function() {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('🔄 New service worker available');
                                    // You could show a notification to the user here
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.error('❌ Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html> 